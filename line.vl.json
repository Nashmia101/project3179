{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Monthly Average Daily Rainfall â€” Small Multiples by State",

  "padding": { "top": 16, "right": 8, "bottom": 28, "left": 6 },   

  "columns": 4,

  "params": [
    {
      "name": "YearPick",
      "value": 2020,
      "bind": { "input": "select", "name": "Year: ", "options": [2014,2015,2016,2017,2018,2019,2020] }
    }
  ],

  "data": {
    "url": "https://raw.githubusercontent.com/Nashmia101/project3179/main/monthly_rainfall_mean_only%20(1).csv",
    "format": {"type": "csv"}
  },

  "transform": [
    { "calculate": "toNumber(datum.year)", "as": "year_num" },
    { "calculate": "toNumber(datum.month)", "as": "mnum" },
    { "calculate": "toNumber(datum.month_mean_mm)", "as": "mm" },
    { "filter": "datum.year_num == YearPick" },
    { "calculate": "['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'][datum.mnum-1]", "as": "month_label" }
  ],

  "facet": {
    "field": "state",
    "type": "nominal",
    "title": null,
    "header": { "labelFontSize": 12 }
  },

  "spec": {
    "width": 240,
    "height": 140,
    "layer": [
      {
        "mark": {"type": "area", "opacity": 0.18, "clip": true},
        "encoding": {
          "x": {
            "field": "mnum", "type": "ordinal", "title": null,
            "scale": {"domain": [1,2,3,4,5,6,7,8,9,10,11,12]},
            "axis": {
              "values": [1,2,3,4,5,6,7,8,9,10,11,12],
              "labelExpr": "['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'][datum.value-1]",
              "labelAngle": 0, "labelFontSize": 10, "tickSize": 0, "labelOverlap": false
            }
          },
          "y": {
            "field": "mm", "type": "quantitative",
            "title": "Average rainfall (mm)",
            "scale": {"zero": true, "nice": true},
            "axis": {
              "labelFontSize": 10,
              "titleFontSize": 10,
              "offset": 0,          
              "titlePadding": 2,    
              "labelPadding": 2     
            }
          },
          "color": {
            "field": "state", "type": "nominal",
            "legend": null,
            "scale": { "scheme": "tableau10" }
          },
          "tooltip": [
            {"field": "state", "title": "State"},
            {"field": "year_num", "type": "quantitative", "title": "Year", "format": "d"},
            {"field": "month_label", "title": "Month"},
            {"field": "mm", "type": "quantitative", "title": "Average rainfall (mm)", "format": ".2f"}
          ]
        }
      },
      {
        "mark": {"type": "line", "point": {"filled": true, "size": 22}, "strokeWidth": 2, "clip": true},
        "encoding": {
          "x": {"field": "mnum", "type": "ordinal"},
          "y": {"field": "mm", "type": "quantitative"},
          "color": {
            "field": "state", "type": "nominal",
            "legend": null,
            "scale": { "scheme": "tableau10" }
          }
        }
      }
    ]
  },

  "resolve": { "scale": { "y": "independent" } },

  "config": {
    "view": { "stroke": null },
    "axis": { "grid": true }
  }
}